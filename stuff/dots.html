<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dots</title>
</head>

<body>
    <style>
        body {
            overflow: hidden;
            margin: 0;
            background: #040815;
        }

        canvas {
            position: fixed;
            left: 0;
            top: 0;
        }
    </style>
    <canvas></canvas>
    <script>
        const canvas = document.querySelector('canvas')
        const ctx = canvas.getContext('2d')
        const w = document.body.clientWidth
        const h = document.documentElement.clientHeight
        const fps = 30
        const fLimit = 100;
        let mx, my = 0;
        canvas.width = w
        canvas.height = h
        let pts = []
        let sources = []
        for (let x = 0; x < w / 10; x++) {
            for (let y = 0; y < h / 10; y++) {
                pts.push({
                    x: 10 * x,
                    y: 10 * y,
                    opx: 10 * x,
                    opy: 10 * y,
                    vx: 0,
                    vy: 0
                })
            }
        }
        for (let n = 0; n < 1; n++) {
            sources.push({
                x: Math.random() * w,
                y: Math.random() * h
            })
        }
        ctx.fillStyle = '#fff'
        canvas.onmousemove = function (e) {
            mx = e.clientX
            my = e.clientY
            sources[0] = {
                x: e.clientX,
                y: e.clientY
            }
        }
        setInterval(function () {
            ctx.clearRect(0, 0, w, h)
            pts.forEach(function (pt, v) {
                let fx = 0;
                let fy = 0;
                sources.forEach(function (s) {
                    if (Math.sqrt((s.x - pt.x) ** 2 + (s.y - pt.y) ** 2) < fLimit) {
                        var fxc = -3*(s.x - pt.x)
                        var fyc = -3*(s.y - pt.y)
                        fx += fxc
                        fy += fyc
                    }
                })
                let dir = Math.atan2(fy, fx)
                ptn = pts[v]
                ptn.vx += 10 * Math.cos(dir) - 10
                ptn.vy += 10 * Math.sin(dir)
                ptn.vx += -2 * (pt.x - pt.opx) / (fps)
                ptn.vy += -2 * (pt.y - pt.opy) / (fps)

                ptn.vx = ptn.vx * 0.9
                ptn.vy = ptn.vy * 0.9
                ptn.x += ptn.vx / fps
                ptn.y += ptn.vy / fps
                ctx.fillRect(ptn.x, ptn.y, 1, 1)
            })
        }, 1000 / fps)
    </script>
</body>

</html>