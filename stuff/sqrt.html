<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <style>
        p {
            padding: none;
        }
        .additions{
            position:absolute;
            width:50%;
        }
    </style>
    <input class='x' placeholder='Number (variable x)'><br>
    <input class='iterations' placeholder='# of iterations'><br>
    <input class='decimals' placeholder='# of decimals in x to account for'> (defaults to 10)<br>
    <button onclick='solve()'>solve</button><br>
    <p class='res'></p><br>
    <br>
    Code example:
    <pre><code>
let x = x*10;                                                  //multiply by 10 to handle decimals.*
let iterations = 5;                                            //higher numbers need more iterations, although 20 should be more than enough for any number
let nps = nearestPerfectSquare(x).squareRoot;                  //this would probably be done by looking through a pre-made table of whole numbers squared
let a = (x - nps*nps)/nps;                                     //initial guess of <i>a</i> - could definitely be improved
let xp1 = x % 1;                                               //save a bit of processing time by pre-calculating unchanging variables
let x2 = x * 2
let sqrtTen = 3.162277660168379331998893...
for (i = 1; i < iterations; i++){                              
    a = ((x2 / ((a / 2) + (xp1 / a)))+a)/2                     //averages 2*(guess of square root of <i>x</i> with new guess of <i>a</i>) and the last value of <i>a</i>
}
let sqrt = -((a / 2) + (xp1 / a))/sqrtTen                      //final iteration (returned values can be negative or positive)

    </code></pre><br>
    <span class='additions'>
*Addition 1:<br>
 multiply by 10 to handle decimals because it does a bit of rounding and is innacurate for decimals as
 a result. If it's multiplied by 10, then you have to divide the square root by sqrt(10) in the final iteration
 to counter this. For handling hundreths places, multiply by 100 and divide by sqrt(100) at the end and so on. Keep
 in mind the denominator can be a pre-calculated constant.<br>
<br>
**Addition 2:<br>
 It's slightly innacurate (at most 1e-9 but usually aroud 1e-16) for the square roots of certain numbers. There's also
 no discernable pattern in which numbers it's innacurate for and increasing the amount of iterations doesn't help.
 Increasing the number of decimals handleable in Addition 1 makes it much more accurate for all numbers but can have an
 effect on execution time.<br>
<br>
***Addition 3:<br>
In some cases, it's faster than the browser's Math.sqrt() when running both only once, although when running both 10 million times Math.sqrt() is around 100 times faster.<br>
<br>
****Addition 4:<br>
This is VERY similar to a method of approximating square roots by repeatedly averaging (Newton-Raphson),
but this is more accurate with less iterations for higher numbers (but this has more steps per iteration).
    </span>
    <script>
        function nearestPerfectSquare(x){
            var value = Math.pow(Math.round(Math.sqrt(x)), 2);
            return {
                value:value,
                squareRoot:value^0.5 //would be done with a table lookup in actual use but to save on memory (this is a browser so I can't hardcode values into storage) it's generated like this
            }
        }
        function solve() {
            let iterations = document.querySelector('.iterations').value;
            let decimals = document.querySelector('.decimals').value
            if(decimals == '') decimals = 10
            let factor = 10**decimals
            var x = document.querySelector('.x').value*factor
            let start = performance.now()
            let nps = nearestPerfectSquare(x).squareRoot;
            let a = (x - nps * nps) / nps
            let xp1 = (x % 1)
            let x2 = x * 2
            for (i = 1; i < iterations; i++) {
                a = ((x2 / ((a / 2) + (xp1 / a))) + a) / 2
            }
            let sqrt = Math.abs(((a / 2) + (xp1 / a))/(10**(decimals >> 1)))
            let end = performance.now()
            var v = x/factor
            let mStart = performance.now()
            let msqrt = Math.sqrt(v)
            let mEnd = performance.now()
            document.querySelector('.res').innerHTML = `This method:  ${sqrt}**<br>
            Math.sqrt(x): ${msqrt}<br>
            Difference: ${msqrt-sqrt}<br>
            Time for this method (ms): ${(end-start)}<br>
            Time for Math.sqrt (ms): ${mEnd-mStart}`
        }



        //other stuff:
        Array.from(document.querySelectorAll('input')).forEach(function(i,v){
            i.style.width = (i.offsetWidth*1.5)+'px'
        })
    </script>
</body>

</html>